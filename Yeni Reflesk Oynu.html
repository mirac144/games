<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Refleks HÄ±z Oyunu</title>
    <style>
        /* CSS BaÅŸlangÄ±cÄ± */
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            font-family: 'Arial', sans-serif;
            background-color: #f0f0f0;
            transition: background-color 0.4s ease; /* Renk geÃ§iÅŸi yumuÅŸak olsun */
        }

        #game-container {
            text-align: center;
            padding: 30px;
            border-radius: 10px;
            background: white;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        #button {
            padding: 15px 30px;
            font-size: 24px;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            background-color: #007bff;
            color: white;
            transition: background-color 0.3s, transform 0.1s;
        }

        #button:hover {
            background-color: #0056b3;
        }

        #button:active {
            transform: scale(0.98);
        }

        .status-text {
            margin-top: 20px;
            font-size: 1.5em;
            color: #333;
            min-height: 40px; /* Metin olmadÄ±ÄŸÄ±nda kaymayÄ± engeller */
        }

        .ready-state {
            background-color: #28a745; /* HazÄ±r bekleniyor (YeÅŸil) */
        }

        .waiting-state {
            background-color: #ffc107; /* Bekleme (SarÄ±) */
        }

        .click-state {
            background-color: #dc3545; /* TÄ±kla Åimdi (KÄ±rmÄ±zÄ±) */
            color: white;
        }

        /* Skor Tablosu Stilleri */
        #score-board-container {
            margin-top: 30px;
            width: 300px;
            padding: 15px;
            border-radius: 8px;
            background: #e9ecef;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        #score-board-container h3 {
            margin-top: 0;
            color: #495057;
        }

        #high-scores {
            list-style: none;
            padding: 0;
        }

        #high-scores li {
            padding: 5px 0;
            border-bottom: 1px dashed #ced4da;
            display: flex;
            justify-content: space-between;
            font-size: 1.1em;
        }

        #high-scores li:last-child {
            border-bottom: none;
        }
        /* CSS BitiÅŸi */
    </style>
</head>
<body>
    <div id="game-container">
        <h1>Refleks HÄ±z Testi</h1>

        <button id="button" onclick="handleGameClick()">HazÄ±r</button>

        <p class="status-text" id="status-message">HazÄ±r tuÅŸuna basarak oyunu baÅŸlatÄ±n.</p>
        <p id="result-display"></p>
    </div>

    <div id="score-board-container">
        <h3>ğŸ† En Ä°yi Skorlar (ms)</h3>
        <ul id="high-scores">
            </ul>
    </div>

    <script>
        // JavaScript BaÅŸlangÄ±cÄ±
        const button = document.getElementById('button');
        const statusMessage = document.getElementById('status-message');
        const resultDisplay = document.getElementById('result-display');
        const body = document.body;
        const scoreList = document.getElementById('high-scores');
        
        let gameState = 'ready'; // ready, waiting, click
        let startTime = null;
        let timeoutId = null;
        const sound = new Audio('https://www.myinstants.com/media/sounds/vine-boom.mp3'); 


        // --- Oyun MantÄ±ÄŸÄ± FonksiyonlarÄ± ---

        function handleGameClick() {
            if (gameState === 'ready') {
                // HazÄ±r -> Bekleme
                startGame();
            } else if (gameState === 'waiting') {
                // Erken TÄ±klama
                earlyClick();
            } else if (gameState === 'click') {
                // DoÄŸru TÄ±klama
                correctClick();
            }
        }

        function startGame() {
            gameState = 'waiting';
            button.textContent = 'Bekle...';
            button.className = 'waiting-state';
            statusMessage.textContent = 'YeÅŸil olunca tÄ±kla...';
            body.className = 'waiting-state';
            resultDisplay.textContent = ''; // Ã–nceki sonucu temizle

            // 3000 ms (3 sn) ile 5000 ms (5 sn) arasÄ±nda rastgele bir bekleme sÃ¼resi
            const randomDelay = Math.random() * (5000 - 3000) + 3000;

            timeoutId = setTimeout(showClickPrompt, randomDelay);
        }

        function showClickPrompt() {
            gameState = 'click';
            button.textContent = 'TIKLA ÅÄ°MDÄ°!';
            button.className = 'click-state';
            statusMessage.textContent = 'Hemen TÄ±kla!';
            body.className = 'click-state';
            startTime = performance.now(); // TÄ±klama sÃ¼resini baÅŸlat
            
            // Sesi Ã§al
            sound.currentTime = 0; // BaÅŸtan baÅŸlat
            sound.play().catch(e => console.log("Ses Ã§alÄ±namadÄ±:", e)); // Otomatik oynatma engellerini yÃ¶netmek iÃ§in catch eklendi.
        }

        function earlyClick() {
            clearTimeout(timeoutId); // ZamanlayÄ±cÄ±yÄ± durdur
            statusMessage.textContent = 'Ã‡ok Erken TÄ±kladÄ±n! Hata.';
            resultDisplay.textContent = 'Tekrar denemek iÃ§in "HazÄ±r" tuÅŸuna bas.';
            resetGame('ready-state');
        }

        function correctClick() {
            const endTime = performance.now();
            const reactionTime = Math.round(endTime - startTime);
            
            statusMessage.textContent = `Tepki SÃ¼ren: ${reactionTime} ms`;
            resultDisplay.textContent = 'Harika! Tekrar oynamak iÃ§in "HazÄ±r" tuÅŸuna bas.';

            saveScore(reactionTime);
            displayScores();
            resetGame('ready-state');
        }

        function resetGame(className) {
            gameState = 'ready';
            startTime = null;
            button.textContent = 'HazÄ±r';
            button.className = className;
            body.className = ''; // VÃ¼cut rengini normale dÃ¶ndÃ¼r
        }

        // --- Skor Tablosu FonksiyonlarÄ± ---

        const STORAGE_KEY = 'refleksHighScores';

        function getScores() {
            const scoresJson = localStorage.getItem(STORAGE_KEY);
            return scoresJson ? JSON.parse(scoresJson) : [];
        }

        function saveScore(newScore) {
            let scores = getScores();
            scores.push(newScore);
            
            // En dÃ¼ÅŸÃ¼k (en iyi) skorlar baÅŸta olacak ÅŸekilde sÄ±rala
            scores.sort((a, b) => a - b); 
            
            // Sadece ilk 10 skoru tut
            scores = scores.slice(0, 10); 
            
            localStorage.setItem(STORAGE_KEY, JSON.stringify(scores));
        }

        function displayScores() {
            const scores = getScores();
            scoreList.innerHTML = ''; // Listeyi temizle

            if (scores.length === 0) {
                const li = document.createElement('li');
                li.textContent = 'HenÃ¼z skor yok. Oynamaya baÅŸla!';
                scoreList.appendChild(li);
                return;
            }

            scores.forEach((score, index) => {
                const li = document.createElement('li');
                li.innerHTML = `<span>#${index + 1}</span> <span>${score} ms</span>`;
                scoreList.appendChild(li);
            });
        }

        // Oyun yÃ¼klendiÄŸinde skorlarÄ± gÃ¶ster
        window.onload = displayScores;

        // JavaScript BitiÅŸi
    </script>
</body>
</html>
